var c=class u extends HTMLElement{static baseVersion="2025-06-03";static _iCount=0;uib=!!window.uibuilder;uibuilder=window.uibuilder;$;$$;connected=!1;name;opts={};static get version(){return`${this.componentVersion} (Base: ${this.baseVersion})`}constructor(){super()}config(e){return e&&(this.opts=u.deepAssign(this.opts,e)),this.opts}createShadowSelectors(){this.$=this.shadowRoot?.querySelector.bind(this.shadowRoot),this.$$=this.shadowRoot?.querySelectorAll.bind(this.shadowRoot)}static deepAssign(e,...t){for(let s of t)for(let i in s){let n=s[i],r=e[i];if(Object(n)==n&&Object(r)===r){e[i]=u.deepAssign(r,n);continue}e[i]=s[i]}return e}async doInheritStyles(){if(!this.shadowRoot||!this.hasAttribute("inherit-style"))return;let e=this.getAttribute("inherit-style");e||(e="./index.css");let t=document.createElement("link");t.setAttribute("type","text/css"),t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),this.shadowRoot.appendChild(t),console.info(`[${this.localName}] Inherit-style requested. Loading: "${e}"`)}ensureId(){this.uib=!!window.uibuilder,this.id||(this.id=`${this.localName}-${++this.constructor._iCount}`)}prependStylesheet(e,t=0){if(!e)throw new Error(`[${this.localName}] cssText must be provided`);let s=this._findExistingStylesheet();if(s)return s;let i=document.createElement("style");return i.textContent=e,i.setAttribute("data-component",this.localName),i.setAttribute("data-order",t.toString()),this._prependToDocumentHead(i,t),i}uibSend(e,t){this.uib&&(this.uibuilder.ioConnected?this.uibuilder.send({topic:`${this.localName}:${e}`,payload:t,id:this.id,name:this.name}):console.warn(`[${this.localName}] uibuilder not connected to server, cannot send:`,e,t))}_connect(){this.ensureId(),this.doInheritStyles(),this.uib&&this.uibuilder.onTopic(`${this.localName}::${this.id}`,this._uibMsgHandler.bind(this))}_construct(e,t){e&&(t||(t={mode:"open",delegatesFocus:!0}),this.attachShadow(t).append(e),this.createShadowSelectors())}_disconnect(){document.removeEventListener(`uibuilder:msg:_ui:update:${this.id}`,this._uibMsgHandler),this._event("disconnected")}_event(e,t){this.dispatchEvent(new CustomEvent(`${this.localName}:${e}`,{bubbles:!0,composed:!0,detail:{id:this.id,name:this.name,data:t}}))}_ready(){this.connected=!0,this._event("connected"),this._event("ready")}_uibMsgHandler(e){if(typeof e.payload!="object"){console.warn(`[${this.localName}] Ignoring msg, payload is not an object:`,e);return}Object.keys(e.payload).forEach(t=>{t.startsWith("_")||(this[t]=e.payload[t])})}_findExistingStylesheet(){return document.head.querySelector(`style[data-component="${this.localName}"]`)}_prependToDocumentHead(e,t){let s=document.head,i=Array.from(s.querySelectorAll("style[data-component]"));if(i.length===0){let r=s.firstChild;r?s.insertBefore(e,r):s.appendChild(e);return}let n=null;for(let r of i){let o=parseInt(r.getAttribute("data-order")??"0",10);if(t<o){n=r;break}}if(n)s.insertBefore(e,n);else{let o=i[i.length-1].nextSibling;o?s.insertBefore(e,o):s.appendChild(e)}}},h=c;var d=document.createElement("template");d.innerHTML=`
    <style>
        :host {
            --value-color: var(--text2, inherit);
            --gauge-background-color: var(--surface2, inherit);
            --hue: 120; /* 0 = red, 120 = green, 240 = blue */
            --on-sat: 100%;
            --off-sat: 20%;
            --on-lum: 45%;
            --off-lum: 25%;
            --label-color: var(--value-color, inherit);
            
            --segment-count: 10;
            --segment-gap: 0.3rem;
            --gauge-columns: 1fr 1fr;
            --gauge-layout: 
                "label value"
                "segments segments"
                "segvals segvals";
            --value-justification: end;

            contain: content; /* performance boost */
            display: grid;
            width: 100%;
            grid-template-columns: var(--gauge-columns);
            grid-template-areas: var(--gauge-layout);
            padding: 1rem;
            background-color: var(--gauge-background-color);
            color: var(--value-color);
            border-radius: var(--border-radius, 5px);
        }

        
        .segments {
            grid-area: segments;
            display: grid;
            grid-template-columns: repeat(var(--segment-count, 10), 1fr);
            gap: var(--segment-gap);
        }

        .segvals {
            grid-area: segvals;
            display: grid;
            grid-template-columns: 0fr repeat(var(--segment-count, 10), 1fr) 0fr;
            justify-items: start;
            /* margin-left: -.5rem; */
            /* gap: var(--segment-gap); */
        }

        .led {
            background-color: hsl(var(--hue, 0), var(--off-sat, 20%), var(--off-lum, 25%));
            height: 20px;
            border-radius: 3px;
            border: 1px solid var(--gauge-background-color);
            cursor: pointer;
        }

        .led.on {
            background-color: hsl(var(--hue, 0), var(--on-sat, 100%), var(--on-lum, 45%));
            /* box-shadow: 0 0 5px hsl(var(--hue, 0), var(--on-sat, 100%), var(--on-lum, 45%)); */
        }

        slot {
            grid-area: label;
            color: var(--label-color, inherit);
        }
        output {
            grid-area: value;
            justify-self: var(--value-justification, end);
            color: var(--value-color, inherit);
        }
    </style>

    <slot></slot>
    <output class="value"></output>
    <div class="segments" arial-label="Visual LED Gauge"></div>
    <div class="segvals"></div>
`;var l=class extends h{static componentVersion="2025-02-25";#e=0;#t=10;#s={};#i=0;#n=100;#r="%";#o=!1;segContainerEl;valsContainerEl;valueEl;segmentElements;static get observedAttributes(){return["inherit-style","name","value","min","max","unit","segments","hide-segment-labels"]}set segments(e){let t=e.toString();this.#t=parseInt(t),this.style.setProperty("--segment-count",t),this._renderGauge()}get segments(){return this.#t}set value(e){let t=this.#e;this.#e=parseFloat(e.toString()),this._renderGauge(),this.connected&&(this._event("value-change",{value:this.#e,oldValue:t}),this.uibSend("value-change",{value:this.#e,oldValue:t}))}get value(){return this.#e}set colors(e){this.#s=e,this._renderGauge()}get colors(){return this.#s}set min(e){this.#i=parseFloat(e.toString()),this._renderGauge()}get min(){return this.#i}set max(e){this.#n=parseFloat(e.toString()),this._renderGauge()}get max(){return this.#n}set unit(e){this.#r=e,this.valueEl.innerText=`${this.value}${this.#r}`}get unit(){return this.#r}set hideSegmentLabels(e){e===""||e===null||e.toString().toLowerCase()==="true"?e=!0:e=!1,this.#o=e,this.valsContainerEl.style.display=e?"none":"grid"}get hideSegmentLabels(){return this.#o}constructor(){super(),d&&d.content&&this._construct(d.content.cloneNode(!0)),this.segContainerEl=this.shadowRoot.querySelector(".segments"),this.valsContainerEl=this.shadowRoot.querySelector(".segvals"),this.valueEl=this.shadowRoot.querySelector(".value")}connectedCallback(){this._connect(),this._renderGauge(),this._ready()}disconnectedCallback(){this._disconnect()}attributeChangedCallback(e,t,s){e==="hide-segment-labels"&&(e="hideSegmentLabels"),t!==s&&(this[e]=s,this._event("attribChanged",{attribute:e,newVal:s,oldVal:t}))}_renderGauge(){let e=(this.#n-this.#i)/this.#t;this.segContainerEl.innerHTML="",this.valsContainerEl.innerHTML="";for(let s=0;s<this.#t;s++){let i=document.createElement("div");i.classList.add("led");let n=this.#i+s*e;if(i.title=n.toString(),s===0){let a=document.createElement("div");this.valsContainerEl.appendChild(a)}let r=document.createElement("div");r.innerText=Math.round(n).toString();let o=Object.keys(this.#s).reverse().find(a=>Number(a)<=n+e-.01);o!==void 0&&i.style.setProperty("--hue",this.#s[o]),this.#e>=n&&i.classList.add("on"),i.addEventListener("click",()=>{let a={gaugeValue:this.#e,segment:s,segmentValue:Number(n)};this._event("segment-click",a),this.uibSend("segment-click",a)}),this.segContainerEl.appendChild(i),this.valsContainerEl.appendChild(r)}this.segmentElements=this.segContainerEl.getElementsByTagName("div");let t=document.createElement("div");this.valsContainerEl.appendChild(t),t.innerText=this.#n.toString(),this.valueEl.innerText=`${this.value}${this.#r}`}},p=l;window.LedGauge=l;customElements.define("led-gauge",l);export{p as default};
//# sourceMappingURL=led-gauge.esm.min.js.map
