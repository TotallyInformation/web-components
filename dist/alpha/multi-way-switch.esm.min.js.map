{
  "version": 3,
  "sources": ["../../src/alpha/multi-way-switch.js"],
  "sourcesContent": ["/** A zero-dependency multi-way switch component.\n * Allows for 3 different display modes: button-row, slider and knob\n *\n * @version 0.1.0 2024-09-14\n *\n * @example\n * <multi-way-switch mode=\"buttons\" positions=\"5\" values=\"10,20,30,40,50\"></multi-way-switch>\n * <multi-way-switch mode=\"slider\" positions=\"3\" values=\"low,medium,high\"></multi-way-switch>\n * <multi-way-switch mode=\"knob\" positions=\"4\" values=\"1,2,4,8\"></multi-way-switch>\n */\n/*\n  Copyright (c) 2024-2024 Julian Knight (Totally Information)\n\n  Licensed under the Apache License, Version 2.0 (the \"License\");\n  you may not use this file except in compliance with the License.\n  You may obtain a copy of the License at\n\n  http://www.apache.org/licenses/LICENSE-2.0\n\n  Unless required by applicable law or agreed to in writing, software\n  distributed under the License is distributed on an \"AS IS\" BASIS,\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n  See the License for the specific language governing permissions and\n  limitations under the License.\n*/\n\n// ! STATUS: Early alpha\n\n/**\n * TODO\n * - warm-up/-down interval/event\n * - better button-row - wrap in fieldset? Add LED option\n * - vert\n * - nicer knob, knob click should rotate clockwise. Allow for shift-click\n * - add an radio button mode with fieldset\n * - Add custom event on value change\n * - Accessibility: aria-pressed, aria-hidden on led's, title/aria-label\n * - touch-action: pan-y, drag\n * - label positioning\n * - value display and positioning\n * - option for sending data immediately to node-red if uibuilder present\n */\n\n/** References\n * https://codepen.io/johnred15/pen/NWXagPZ - simple with size/colour options\n * https://webcodespace.com/how-to-create-a-three-state-toggle-switch-using-html-css-and-javascript\n * https://www.w3schools.com/howto/howto_css_switch.asp\n */\n\nconst template = document.createElement('template')\ntemplate.innerHTML = /*html*/`\n    <style>\n        :host {\n            display: inline-block;\n        }\n        .buttons, .slider, .knob {\n            display: none;\n        }\n        .buttons button {\n            margin-right: 5px;\n        }\n        .slider input[type=\"range\"] {\n            width: 100%;\n        }\n        .knob {\n            width: 100px;\n            height: 100px;\n            background-color: lightgray;\n            border-radius: 50%;\n            position: relative;\n        }\n        .knob-handle {\n            position: absolute;\n            width: 10px;\n            height: 50px;\n            background-color: darkgray;\n            top: 25px;\n            left: 45px;\n            transform-origin: bottom center;\n            transform: rotate(0deg);\n        }\n        :host([mode=\"buttons\"]) .buttons {\n            display: block;\n        }\n        :host([mode=\"slider\"]) .slider {\n            display: block;\n        }\n        :host([mode=\"knob\"]) .knob {\n            display: block;\n        }\n    </style>\n\n    <div class=\"buttons\"></div>\n    <div class=\"slider\">\n        <input type=\"range\" min=\"0\" max=\"100\" value=\"0\">\n    </div>\n    <div class=\"knob\">\n        <div class=\"knob-handle\"></div>\n    </div>\n`\n\nclass MultiWaySwitch extends HTMLElement {\n    //#region --- Class Properties ---\n\n    /** Is UIBUILDER loaded? */\n    uib = !!window['uibuilder']\n\n    /** Mini jQuery-like shadow dom selector (see constructor) */\n    $\n\n    /** Holds a count of how many instances of this component are on the page */\n    static _iCount = 0\n\n    //#endregion --- Class Properties ---\n\n    /** @returns {Array<string>} List of all of the html attribs (props) listened to */\n    static get observedAttributes() {\n        return ['mode', 'positions', 'values']\n    }\n\n    constructor() {\n        super()\n\n        this.attachShadow({ mode: 'open', delegatesFocus: true })\n            .append(template.content.cloneNode(true))\n\n        // @ts-ignore\n        this.$ = this.shadowRoot.querySelector.bind(this.shadowRoot)\n\n        this._value = 0\n        this.knobRotation = 0\n        this._customValues = []\n\n        this.dispatchEvent(new Event('multi-way-switch:construction-complete', { bubbles: true, composed: true }))\n    }\n\n    attributeChangedCallback(name, oldVal, newVal) {\n        if ( oldVal === newVal ) return\n        if (name === 'positions' || name === 'values') {\n            this._setupButtons()\n            this._setupSlider()\n        }\n    }\n\n    connectedCallback() {\n        // Make sure instance has an ID. Create an id from name or calculation if needed\n        if (!this.id) {\n            if (!this.name) this.name = this.getAttribute('name')\n            if (this.name) this.id = this.name.toLowerCase().replace(/\\s/g, '_')\n            else this.id = `uib-meta-${++MultiWaySwitch._iCount}`\n        }\n\n        this._setupButtons()\n        this._setupSlider()\n        this._setupKnob()\n    }\n\n    get value() {\n        return this._customValues[this._value] || this._value\n    }\n\n    set value(newValue) {\n        this._value = newValue\n        this._updateUI()\n    }\n\n    _setupButtons() {\n        const buttonsContainer = this.shadowRoot.querySelector('.buttons')\n        buttonsContainer.innerHTML = ''\n\n        const positions = Math.max(2, Math.min(parseInt(this.getAttribute('positions'), 10), 255)) || 2\n        this._customValues = this._parseValues(positions)\n\n        for (let i = 0; i < positions; i++) {\n            const button = document.createElement('button')\n            button.textContent = `Pos ${i + 1}`\n            button.addEventListener('click', () => {\n                this.value = i\n            })\n            buttonsContainer.appendChild(button)\n        }\n    }\n\n    _setupSlider() {\n        const slider = this.shadowRoot.querySelector('input[type=\"range\"]')\n        const positions = Math.max(2, Math.min(parseInt(this.getAttribute('positions'), 10), 255)) || 2\n        slider.max = positions - 1\n        slider.addEventListener('input', () => {\n            this.value = slider.value\n        })\n    }\n\n    _setupKnob() {\n        const knob = this.shadowRoot.querySelector('.knob')\n        const handle = this.shadowRoot.querySelector('.knob-handle')\n        const positions = Math.max(2, Math.min(parseInt(this.getAttribute('positions'), 10), 255)) || 2\n\n        knob.addEventListener('mousedown', (event) => {\n            const knobCenter = { x: knob.offsetLeft + knob.offsetWidth / 2, y: knob.offsetTop + knob.offsetHeight / 2 }\n            const onMouseMove = (moveEvent) => {\n                const dx = moveEvent.pageX - knobCenter.x\n                const dy = moveEvent.pageY - knobCenter.y\n                this.knobRotation = Math.atan2(dy, dx) * (180 / Math.PI)\n                handle.style.transform = `rotate(${this.knobRotation}deg)`\n                const position = Math.round(((this.knobRotation + 180) % 360) / 360 * (positions - 1))\n                this.value = position\n            };\n\n            const onMouseUp = () => {\n                window.removeEventListener('mousemove', onMouseMove)\n                window.removeEventListener('mouseup', onMouseUp)\n            };\n\n            window.addEventListener('mousemove', onMouseMove)\n            window.addEventListener('mouseup', onMouseUp)\n        })\n    }\n\n    _parseValues(positions) {\n        const valuesAttr = this.getAttribute('values')\n        if (valuesAttr) {\n            const values = valuesAttr.split(',').map(val => val.trim())\n            if (values.length >= positions) {\n                return values.slice(0, positions)\n            } else {\n                return [...values, ...Array(positions - values.length).fill(values[values.length - 1])]\n            }\n        } else {\n            return Array.from({ length: positions }, (_, i) => i)\n        }\n    }\n\n    _updateUI() {\n        const slider = this.shadowRoot.querySelector('input[type=\"range\"]')\n        slider.value = this._value\n\n        const buttons = this.shadowRoot.querySelectorAll('.buttons button')\n        buttons.forEach((button, index) => {\n            button.style.backgroundColor = index === this._value ? 'lightblue' : ''\n        })\n\n        const handle = this.shadowRoot.querySelector('.knob-handle')\n        const positions = Math.max(2, Math.min(parseInt(this.getAttribute('positions'), 10), 255)) || 2\n        this.knobRotation = (this._value / (positions - 1)) * 360 - 180\n        handle.style.transform = `rotate(${this.knobRotation}deg)`\n    }\n}\n\n/** Self register the class to global\n * Enables new data to be dynamically added via JS\n * and lets any static methods be called\n */\nwindow['MultiWaySwitch'] = MultiWaySwitch\n\n// Add the class as a new Custom Element to the window object\ncustomElements.define('multi-way-switch', MultiWaySwitch)\n"],
  "mappings": "AAiDA,IAAMA,EAAW,SAAS,cAAc,UAAU,EAClDA,EAAS,UAAoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmD7B,IAAMC,EAAN,MAAMC,UAAuB,WAAY,CAIrC,IAAM,CAAC,CAAC,OAAO,UAGf,EAGA,OAAO,QAAU,EAKjB,WAAW,oBAAqB,CAC5B,MAAO,CAAC,OAAQ,YAAa,QAAQ,CACzC,CAEA,aAAc,CACV,MAAM,EAEN,KAAK,aAAa,CAAE,KAAM,OAAQ,eAAgB,EAAK,CAAC,EACnD,OAAOF,EAAS,QAAQ,UAAU,EAAI,CAAC,EAG5C,KAAK,EAAI,KAAK,WAAW,cAAc,KAAK,KAAK,UAAU,EAE3D,KAAK,OAAS,EACd,KAAK,aAAe,EACpB,KAAK,cAAgB,CAAC,EAEtB,KAAK,cAAc,IAAI,MAAM,yCAA0C,CAAE,QAAS,GAAM,SAAU,EAAK,CAAC,CAAC,CAC7G,CAEA,yBAAyBG,EAAMC,EAAQC,EAAQ,CACtCD,IAAWC,IACZF,IAAS,aAAeA,IAAS,YACjC,KAAK,cAAc,EACnB,KAAK,aAAa,EAE1B,CAEA,mBAAoB,CAEX,KAAK,KACD,KAAK,OAAM,KAAK,KAAO,KAAK,aAAa,MAAM,GAChD,KAAK,KAAM,KAAK,GAAK,KAAK,KAAK,YAAY,EAAE,QAAQ,MAAO,GAAG,EAC9D,KAAK,GAAK,YAAY,EAAED,EAAe,OAAO,IAGvD,KAAK,cAAc,EACnB,KAAK,aAAa,EAClB,KAAK,WAAW,CACpB,CAEA,IAAI,OAAQ,CACR,OAAO,KAAK,cAAc,KAAK,MAAM,GAAK,KAAK,MACnD,CAEA,IAAI,MAAMI,EAAU,CAChB,KAAK,OAASA,EACd,KAAK,UAAU,CACnB,CAEA,eAAgB,CACZ,IAAMC,EAAmB,KAAK,WAAW,cAAc,UAAU,EACjEA,EAAiB,UAAY,GAE7B,IAAMC,EAAY,KAAK,IAAI,EAAG,KAAK,IAAI,SAAS,KAAK,aAAa,WAAW,EAAG,EAAE,EAAG,GAAG,CAAC,GAAK,EAC9F,KAAK,cAAgB,KAAK,aAAaA,CAAS,EAEhD,QAASC,EAAI,EAAGA,EAAID,EAAWC,IAAK,CAChC,IAAMC,EAAS,SAAS,cAAc,QAAQ,EAC9CA,EAAO,YAAc,OAAOD,EAAI,CAAC,GACjCC,EAAO,iBAAiB,QAAS,IAAM,CACnC,KAAK,MAAQD,CACjB,CAAC,EACDF,EAAiB,YAAYG,CAAM,CACvC,CACJ,CAEA,cAAe,CACX,IAAMC,EAAS,KAAK,WAAW,cAAc,qBAAqB,EAC5DH,EAAY,KAAK,IAAI,EAAG,KAAK,IAAI,SAAS,KAAK,aAAa,WAAW,EAAG,EAAE,EAAG,GAAG,CAAC,GAAK,EAC9FG,EAAO,IAAMH,EAAY,EACzBG,EAAO,iBAAiB,QAAS,IAAM,CACnC,KAAK,MAAQA,EAAO,KACxB,CAAC,CACL,CAEA,YAAa,CACT,IAAMC,EAAO,KAAK,WAAW,cAAc,OAAO,EAC5CC,EAAS,KAAK,WAAW,cAAc,cAAc,EACrDL,EAAY,KAAK,IAAI,EAAG,KAAK,IAAI,SAAS,KAAK,aAAa,WAAW,EAAG,EAAE,EAAG,GAAG,CAAC,GAAK,EAE9FI,EAAK,iBAAiB,YAAcE,GAAU,CAC1C,IAAMC,EAAa,CAAE,EAAGH,EAAK,WAAaA,EAAK,YAAc,EAAG,EAAGA,EAAK,UAAYA,EAAK,aAAe,CAAE,EACpGI,EAAeC,GAAc,CAC/B,IAAMC,EAAKD,EAAU,MAAQF,EAAW,EAClCI,EAAKF,EAAU,MAAQF,EAAW,EACxC,KAAK,aAAe,KAAK,MAAMI,EAAID,CAAE,GAAK,IAAM,KAAK,IACrDL,EAAO,MAAM,UAAY,UAAU,KAAK,YAAY,OACpD,IAAMO,EAAW,KAAK,OAAQ,KAAK,aAAe,KAAO,IAAO,KAAOZ,EAAY,EAAE,EACrF,KAAK,MAAQY,CACjB,EAEMC,EAAY,IAAM,CACpB,OAAO,oBAAoB,YAAaL,CAAW,EACnD,OAAO,oBAAoB,UAAWK,CAAS,CACnD,EAEA,OAAO,iBAAiB,YAAaL,CAAW,EAChD,OAAO,iBAAiB,UAAWK,CAAS,CAChD,CAAC,CACL,CAEA,aAAab,EAAW,CACpB,IAAMc,EAAa,KAAK,aAAa,QAAQ,EAC7C,GAAIA,EAAY,CACZ,IAAMC,EAASD,EAAW,MAAM,GAAG,EAAE,IAAIE,GAAOA,EAAI,KAAK,CAAC,EAC1D,OAAID,EAAO,QAAUf,EACVe,EAAO,MAAM,EAAGf,CAAS,EAEzB,CAAC,GAAGe,EAAQ,GAAG,MAAMf,EAAYe,EAAO,MAAM,EAAE,KAAKA,EAAOA,EAAO,OAAS,CAAC,CAAC,CAAC,CAE9F,KACI,QAAO,MAAM,KAAK,CAAE,OAAQf,CAAU,EAAG,CAACiB,EAAGhB,IAAMA,CAAC,CAE5D,CAEA,WAAY,CACR,IAAME,EAAS,KAAK,WAAW,cAAc,qBAAqB,EAClEA,EAAO,MAAQ,KAAK,OAEJ,KAAK,WAAW,iBAAiB,iBAAiB,EAC1D,QAAQ,CAACD,EAAQgB,IAAU,CAC/BhB,EAAO,MAAM,gBAAkBgB,IAAU,KAAK,OAAS,YAAc,EACzE,CAAC,EAED,IAAMb,EAAS,KAAK,WAAW,cAAc,cAAc,EACrDL,EAAY,KAAK,IAAI,EAAG,KAAK,IAAI,SAAS,KAAK,aAAa,WAAW,EAAG,EAAE,EAAG,GAAG,CAAC,GAAK,EAC9F,KAAK,aAAgB,KAAK,QAAUA,EAAY,GAAM,IAAM,IAC5DK,EAAO,MAAM,UAAY,UAAU,KAAK,YAAY,MACxD,CACJ,EAMA,OAAO,eAAoBZ,EAG3B,eAAe,OAAO,mBAAoBA,CAAc",
  "names": ["template", "MultiWaySwitch", "_MultiWaySwitch", "name", "oldVal", "newVal", "newValue", "buttonsContainer", "positions", "i", "button", "slider", "knob", "handle", "event", "knobCenter", "onMouseMove", "moveEvent", "dx", "dy", "position", "onMouseUp", "valuesAttr", "values", "val", "_", "index"]
}
