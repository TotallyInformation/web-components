(()=>{var h=class r extends HTMLElement{static baseVersion="2025-01-11";static _iCount=0;uib=!!window.uibuilder;uibuilder=window.uibuilder;$;$$;connected=!1;name;opts={};static get version(){return`${this.componentVersion} (Base: ${this.baseVersion})`}constructor(){super()}async doInheritStyles(){if(!this.hasAttribute("inherit-style"))return;let e=this.getAttribute("inherit-style");e||(e="./index.css");let t=document.createElement("link");t.setAttribute("type","text/css"),t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),this.shadowRoot.appendChild(t),console.info(`[${this.localName}] Inherit-style requested. Loading: "${e}"`)}config(e){return e&&(this.opts=r.deepAssign(this.opts,e)),this.opts}static deepAssign(e,...t){for(let i of t)for(let n in i){let s=i[n],o=e[n];if(Object(s)==s&&Object(o)===o){e[n]=r.deepAssign(o,s);continue}e[n]=i[n]}return e}ensureId(){this.uib=!!window.uibuilder,this.id||(this.id=`${this.localName}-${++this.constructor._iCount}`)}createShadowSelectors(){this.$=this.shadowRoot?.querySelector.bind(this.shadowRoot),this.$$=this.shadowRoot?.querySelectorAll.bind(this.shadowRoot)}_uibMsgHandler(e){}_event(e,t){this.dispatchEvent(new CustomEvent(`${this.localName}:${e}`,{bubbles:!0,composed:!0,detail:{id:this.id,name:this.name,data:t}}))}uibSend(e,t){this.uib&&this.uibuilder.send({topic:`${this.localName}:${e}`,payload:t,id:this.id,name:this.name})}_construct(e,t){t||(t={mode:"open",delegatesFocus:!0}),this.attachShadow(t).append(e),this.createShadowSelectors()}_connect(){this.ensureId(),this.doInheritStyles()}_disconnect(){document.removeEventListener(`uibuilder:msg:_ui:update:${this.id}`,this._uibMsgHandler),this._event("disconnected")}_ready(){this.connected=!0,this._event("connected"),this._event("ready")}},u=h;var l=class extends u{static componentVersion="2024-10-06";static get observedAttributes(){return["inherit-style","name"]}#e;#t;elThead;elTfoot;elTbody;set data(e){e!==null&&e!==this.#e&&(this.#e=this._createProxy(e),this.#t||this._buildCols(!0),this._buildHeadings(),this._buildRows())}get data(){return this.#e}constructor(){super()}connectedCallback(){this._connect(),this._buildTblOutline(),this._ready()}disconnectedCallback(){this._disconnect()}attributeChangedCallback(e,t,i){this.connected&&t!==i&&(this[e]=i,this._event("attribChanged",{attribute:e,newVal:i,oldVal:t}))}getValueByOffset(e,t,i){let n=Object.keys(e),s=Object.keys(e[n[t]]),o=n[t],a=s[i];return e[o][a]}getCellById(e){let t=this.elTbody.querySelector(`td[data-cell="${e}"]`);return t||console.warn(`[${this.localName}:getCellById:${this.id}] Invalid cell reference "${e}"`),t}getValueByCellId(e){let[,t,i]=e.split(/^R(\d+)C(\d+)$/ig);return t=Number(t)-1,i=Number(i)-1,Number.isNaN(t)||Number.isNaN(i)?(console.warn(`[${this.localName}:getValueByCellId:${this.id}] Invalid cell reference "${e}"`),null):this.getValueByOffset(this.#e,t,i)}_createProxy(e,t=null){return new Proxy(e,{get:(i,n)=>{let s=i[n];return Array.isArray(s)||typeof s=="object"&&s!==null?t!==null?(console.warn(`[${this.localName}:_createProxy:${this.id}] Data is >2d. Can only deal with 2d (tabular) data.`),s):this._createProxy(s,n):s},set:(i,n,s)=>{let o=!(n in i);return i[n]=s,o?this._onDataChange(t,n,s,"added"):this._onDataChange(t,n,s,"modified"),!0},deleteProperty:(i,n)=>{let s=i[n],o=delete i[n];return o&&this._onDataChange(t,n,s,"deleted"),o}})}_onDataChange(e,t,i,n){this.elThead.replaceChildren(""),this.elTfoot.replaceChildren(""),this.elTbody.replaceChildren(""),this.#t||this._buildCols(!0),this._buildHeadings(),this._buildRows()}_buildTblOutline(){let e=document.createElement("table");e.innerHTML=`
        <thead></thead>
        <tfoot></tfoot>
        <tbody></tbody>
        `,this.prepend(e),this.elThead=e.getElementsByTagName("thead")[0],this.elTfoot=e.getElementsByTagName("tfoot")[0],this.elTbody=e.getElementsByTagName("tbody")[0]}_buildCols(e){this.#t={};let t=this.#e[Object.keys(this.#e)[0]];Array.isArray(t)?t.forEach((i,n)=>{let s=`C${n+1}`;this.#t[s]={id:s,name:`Column ${n+1}`,type:typeof i,title:void 0}}):Object.keys(t).forEach(i=>{this.#t[i]={id:i,name:i,type:typeof i,title:void 0}})}_buildHeadings(){let e="H1R1",t=document.createElement("tr");t.dataset.row=e,Object.keys(this.#t).forEach((i,n)=>{let s=document.createElement("th");s.dataset.row=e,s.dataset.col=this.#t[i].id,s.innerText=this.#t[i].name,t.appendChild(s)}),this.elThead.appendChild(t)}_buildRows(){Object.keys(this.#e).forEach((e,t)=>{this._buildRow(t,e,this.#e[e])})}_buildRow(e,t,i){let n=Number(t),s=Number.isNaN(n)?t:`R${n+1}`,o=document.createElement("tr");o.dataset.row=s,Object.keys(this.#t).forEach((a,c)=>{let d=document.createElement("td");d.dataset.row=s,d.dataset.col=this.#t[a].id,d.dataset.cell=`R${e+1}C${c+1}`,d.innerText=this.#e[t][a]===void 0?this.#e[e][c]:this.#e[t][a],o.appendChild(d)}),this.elTbody.appendChild(o)}},m=l;window.SmartTable=l;customElements.define("smart-table",l);})();
//# sourceMappingURL=smart-table.iife.min.js.map
